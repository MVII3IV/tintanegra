<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Crear/Editar Pedido</title>

    <!-- Tus enlaces CSS existentes -->
    <link rel="stylesheet" href="assets/css/bootstrap.rtl.min.css" />
    <link rel="stylesheet" href="assets/css/swiper-bundle.min.css" />
    <link rel="stylesheet" href="assets/css/scrollCue.css" />
    <link rel="stylesheet" href="assets/css/boxicons.min.css" />
    <link rel="stylesheet" href="assets/fonts/flaticon_pozu.css" />
    <link rel="stylesheet" href="assets/css/navbar.css" />
    <link rel="stylesheet" href="assets/css/footer.css" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/responsive.css" />
    <link rel="stylesheet" href="assets/css/rtl.css" />
    <link rel="stylesheet" href="assets/css/orders.css" /> <!-- Tus estilos específicos de pedidos -->

    <!-- Tus scripts existentes -->
    <script src="assets/js/swiper-bundle.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>

    <style>
        /* Estilos específicos para este formulario, si necesitas sobrescribir algo */
        .pedido-container {
            max-width: 1080px;
            margin: 48px auto;
            padding: 28px;
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.06);
        }
        .section-title {
            font-size: 1.05rem;
            font-weight: 600;
            margin-bottom: 15px; /* Aumentado ligeramente para los títulos de sección */
            color: #111827;
        }
        .form-label {
            font-weight: 600;
            color: #111827;
            margin-bottom: 8px;
        }
        .talla-entry {
            background-color: #f9f9f9;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .talla-entry:last-of-type {
            margin-bottom: 0;
        }
        .talla-entry .form-control {
            flex-grow: 1; /* Para que ocupen el espacio disponible */
        }
        .talla-entry .btn-danger {
            flex-shrink: 0; /* Para que el botón no se encoja */
        }
    </style>
  </head>
  <body>
    <!-- Asumiendo que tienes un navbar aquí si usas tu navbar.css -->
    <!-- <nav class="navbar ..."></nav> -->

    <div class="pedido-container">
        <div class="pedido-header text-center mb-5">
            <h2>Gestionar Pedido</h2>
            <p class="pedido-subtitle">Crea o edita los detalles de un pedido.</p>
        </div>

        <form id="pedidoForm" action="createOrder.php" method="POST" enctype="multipart/form-data">
            
            <div class="card-soft mb-4 p-4">
                <div class="section-title text-center mb-4">Información General</div>
                <div class="mb-3">
                    <label for="nombre" class="form-label">Nombre del Pedido</label>
                    <input type="text" class="form-control" id="nombre" name="nombre" required>
                </div>
                
                <div class="row g-3">
                    <div class="col-md-4 mb-3">
                        <label for="status" class="form-label">Estado</label>
                        <select class="form-select" id="status" name="status" required>
                            <option value="Recibida">Recibida</option>
                            <option value="Anticipo recibido">Anticipo Recibido</option>
                            <option value="En produccion">En Producción</option>
                            <option value="Finalizada">Finalizada</option>
                            <option value="Entregada">Entregada</option>
                        </select>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="fechaInicio" class="form-label">Fecha de Inicio</label>
                        <input type="date" class="form-control" id="fechaInicio" name="fechaInicio" required>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="fechaEntrega" class="form-label">Fecha Estimada de Entrega</label>
                        <input type="date" class="form-control" id="fechaEntrega" name="fechaEntrega" required>
                    </div>
                </div>

                <div class="row g-3">
                    <div class="col-md-6 mb-3">
                        <label for="costo" class="form-label">Costo Total</label>
                        <input type="number" step="0.01" class="form-control" id="costo" name="costo" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="anticipo" class="form-label">Anticipo Recibido</label>
                        <input type="number" step="0.01" class="form-control" id="anticipo" name="anticipo" value="0.00">
                    </div>
                </div>
            </div> <!-- End card-soft General Info -->

            <div class="card-soft mb-4 p-4">
                <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-4">
                    <div class="section-title mb-0">Tallas y Colores</div>
                    <button type="button" id="addTalla" class="btn btn-outline-primary btn-sm"><i class="bx bx-plus me-1"></i> Añadir Talla</button>
                </div>
                
                <div id="tallasContainer">
                    <!-- Campo inicial de talla -->
                    <div class="talla-entry d-flex align-items-center gap-2">
                        <input type="text" class="form-control" name="talla[]" placeholder="Talla (Ej: S, M, L)">
                        <input type="number" class="form-control" name="cantidad[]" placeholder="Cantidad" value="1" min="1">
                        <input type="color" class="form-control form-control-color" name="color[]" value="#563d7c" title="Elige tu color">
                        <button type="button" class="btn btn-danger btn-sm remove-talla"><i class="bx bx-trash"></i></button>
                    </div>
                </div>
            </div> <!-- End card-soft Tallas y Colores -->

            <div class="card-soft mb-4 p-4">
                <div class="section-title text-center mb-4">Imágenes del Pedido y Paleta</div>
                
                <div class="mb-4">
                    <label for="imagenes" class="form-label">Subir Imágenes del Diseño (múltiples)</label>
                    <input type="file" class="form-control" id="imagenes" name="imagenes[]" multiple accept="image/*">
                    <small class="form-text text-muted">Sube una o más imágenes relacionadas con el diseño del pedido.</small>
                </div>

                <div class="mb-3">
                    <label for="paletaColor" class="form-label">Subir Imagen de Paleta de Colores (una)</label>
                    <input type="file" class="form-control" id="paletaColor" name="paletaColor" accept="image/*">
                    <small class="form-text text-muted">Sube una única imagen que represente la paleta de colores del pedido.</small>
                </div>
            </div> <!-- End card-soft Imágenes -->

            <div class="d-grid mt-4">
                <button type="submit" class="btn btn-primary btn-lg">Guardar Pedido</button>
            </div>
        </form>
    </div>

    <!-- Asumiendo que tienes un footer aquí si usas tu footer.css -->
    <!-- <footer class="footer ..."></footer> -->

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Script para añadir/eliminar campos de talla
            const tallasContainer = document.getElementById('tallasContainer');
            document.getElementById('addTalla').addEventListener('click', function() {
                const newTallaEntry = document.createElement('div');
                newTallaEntry.className = 'talla-entry d-flex align-items-center gap-2';
                newTallaEntry.innerHTML = `
                    <input type="text" class="form-control" name="talla[]" placeholder="Talla (Ej: S, M, L)">
                    <input type="number" class="form-control" name="cantidad[]" placeholder="Cantidad" value="1" min="1">
                    <input type="color" class="form-control form-control-color" name="color[]" value="#563d7c" title="Elige tu color">
                    <button type="button" class="btn btn-danger btn-sm remove-talla"><i class="bx bx-trash"></i></button>
                `;
                tallasContainer.appendChild(newTallaEntry);
            });

            tallasContainer.addEventListener('click', function(e) {
                if (e.target.classList.contains('remove-talla') || e.target.closest('.remove-talla')) {
                    const button = e.target.classList.contains('remove-talla') ? e.target : e.target.closest('.remove-talla');
                    if (tallasContainer.children.length > 1) { // No permitir eliminar el último campo
                        button.closest('.talla-entry').remove();
                    } else {
                        alert('Debe haber al menos una talla.');
                    }
                }
            });

            // Opcional: Establecer la fecha actual por defecto en los campos de fecha
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('fechaInicio').value = today;
            // document.getElementById('fechaEntrega').value = today; // Puedes ajustar para una fecha futura
        });
    </script>
  </body>
</html>